<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Cliente</title>
    <script>
        function atualizarFormulario() {
            const tipo = document.querySelector('input[name="tipo"]:checked').value;
            document.getElementById('label_doc').innerText = tipo === 'pj' ? 'CNPJ:' : 'CPF:';
            document.getElementById('documento').value = '';
            document.getElementById('campo_contato').style.display = tipo === 'pj' ? 'block' : 'none';
        }
        function buscarEndereco() {
            const cep = document.getElementById('cep').value.replace(/\D/g, '');
            if (cep.length !== 8) return;
            fetch('https://viacep.com.br/ws/' + cep + '/json/')
                .then(res => res.json())
                .then(data => {
                    if (!data.erro) {
                        document.getElementById('endereco').value = data.logradouro;
                        document.getElementById('bairro').value = data.bairro;
                    }
                });
        }
        function formatarDocumento(input) {
            let v = input.value.replace(/\D/g, '');
            if (v.length <= 11) {
                v = v.replace(/(\d{3})(\d)/, '$1.$2');
                v = v.replace(/(\d{3})(\d)/, '$1.$2');
                v = v.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            } else {
                v = v.replace(/(\d{2})(\d)/, '$1.$2');
                v = v.replace(/(\d{3})(\d)/, '$1.$2');
                v = v.replace(/(\d{3})(\d)/, '$1/$2');
                v = v.replace(/(\d{4})(\d{1,2})$/, '$1-$2');
            }
            input.value = v;
        }
        function formatarCelular(input) {
            let v = input.value.replace(/\D/g, '');
            v = v.replace(/(\d{2})(\d)/, '($1) $2');
            v = v.replace(/(\d{5})(\d{4})$/, '$1-$2');
            input.value = v;
        }
        function formatarTextoInicialMaiuscula(input) {
            input.value = input.value.toLowerCase().replace(/\b(\w{3,})/g, function(txt) {
                return txt.charAt(0).toUpperCase() + txt.substr(1);
            });
        }
        function formatarMinusculo(input) {
            input.value = input.value.toLowerCase();
        }
    </script>
</head>
<body onload="atualizarFormulario()">
    <h1>Cadastro de Cliente</h1>
    <form method="POST">
        <label><input type="radio" name="tipo" value="pf" checked onchange="atualizarFormulario()"> Pessoa Física</label>
        <label><input type="radio" name="tipo" value="pj" onchange="atualizarFormulario()"> Pessoa Jurídica</label><br><br>

        <label>Nome / Razão Social:</label><br>
        <input type="text" name="nome" onblur="formatarTextoInicialMaiuscula(this)" required><br><br>

        <label id="label_doc">CPF:</label><br>
        <input type="text" id="documento" name="documento" oninput="formatarDocumento(this)" required><br><br>

        <label>Celular:</label><br>
        <input type="text" name="celular" oninput="formatarCelular(this)" required><br><br>

        <div id="campo_contato" style="display: none;">
            <label>Contato:</label><br>
            <input type="text" name="contato" onblur="formatarTextoInicialMaiuscula(this)"><br><br>
        </div>

        <label>CEP:</label><br>
        <input type="text" id="cep" name="cep" onblur="buscarEndereco()" required><br><br>

        <label>Endereço:</label><br>
        <input type="text" id="endereco" name="endereco" required><br><br>

        <label>Número:</label><br>
        <input type="text" name="numero"><br><br>

        <label>Complemento:</label><br>
        <input type="text" name="complemento" onblur="formatarTextoInicialMaiuscula(this)"><br><br>

        <label>Bairro:</label><br>
        <input type="text" id="bairro" name="bairro" required><br><br>

        <label>Email:</label><br>
        <input type="email" name="email" onblur="formatarMinusculo(this)"><br><br>

        <label>Observação:</label><br>
        <textarea name="observacao" onblur="formatarTextoInicialMaiuscula(this)"></textarea><br><br>

        <button type="submit">Salvar</button>
    </form>
</body>
</html>
